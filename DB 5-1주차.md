## Natural Join

**natural Join : 공통 열(column)의 이름이 같은 경우, 자동으로 그 열을 기준으로 테이블을 조인하는 문법**

중복되는 공통 열은 하나만 결과에 남긴다

```ruby
## 예시 1

SELECT country.name, city.name
FROM country NATURAL JOIN city;

## 예시 2

SELECT country.name, city.name
FROM country, city
WHERE country.ID = city.ID;
```

만약 공통된 열이 ID만 있다면, 예시 1과 예시 2는 같은 의미이다

즉, 우리가 예시 2처럼 사용한 코드가 바로 natural join이다 

<br/>

또한, **natural join은 3개 이상 결합할 수 있고, 만약 공통된 열이 2개 이상이라면, 모든 열이 동일해야 병합한다**

<br/>

```ruby
## table 3개 병합

SELECT *
FROM A
NATURAL JOIN B
NATURAL JOIN C;
```

<br/>

## natural join의 위험성 

공통 열의 정보를 **자동으로 병합하기 때문에**

**의도하지 않은 열이 자동으로 매치될 수 있음**

이것을 해결하기 위해 **JOIN ... USING 문법 사용**

<br/>

```ruby
SELECT name, title
FROM (student NATURAL JOIN takes) JOIN course USING (course_id);
```

이해를 위해 아래 기본형을 토대로 설명함 

```ruby
SELECT column1, column2, ...
FROM table1
JOIN table2
USING (common_column);
```

기본형을 보면 **table1과 table를 common_column 열을 기준으로 병합한다는 의미이다**

이때, **common_column은 table1과 table2 둘 다에 존재하고 이름도 같은 열이여야 함**

다시 처음 예시를 봐보면 

<br/>

```ruby
SELECT name, title
FROM (student NATURAL JOIN takes) JOIN course USING (course_id);
```

위 코드의 student natural join takes 부분에서 student는 course_id를 가지고 있지 않지만, takes는 가지고 있음 

이렇게 **병합을 한 기준으로 동일한 열이 있어야 하는거지 병합 전에는 한쪽 테이블에 없어도 됨**

또한 common_column은 아래와 같이 여러 열을 지정할 수 있음 

<br>

```ruby
SELECT *
FROM teaches
JOIN section
USING (course_id, sec_id, semester, year);
```

<br/>

## on

JOIN 연산에서 결합될 테이블 간의 조건을 정의할 때 사용하는 키워드로, 두 테이블 간의 일반적인 조건을 표현할 수 있다

ON 절에서 조건을 지정할 때는 일반적인 WHERE 절과 유사한 형태로 작성됨

즉, **on은 where과 역할이 동일하지만 작성 방법만 다름**

```ruby
select student.name 
from student join takes on student.id = takes.id;
```

위 코드와 같이 join으로 두 table을 연결하고, on 뒤에 조건을 걸어서 사용하는 방식이다 

위에 작성한 코드는 아래와 동치이다 

```ruby
select student.name
from student,takes
where student.id = takes.id;
```





























































































































